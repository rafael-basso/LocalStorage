<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage - JS</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <fieldset>
        <legend>Insert Data</legend>
        <input type="text" placeholder="Enter Name.." id="inputKey">
        <input type="text" placeholder="Enter Password..." id="inputValue">
        <button id="btnInsert">Insert</button>
    </fieldset>

    <fieldset>
        <legend>Delete Data</legend>
        <input type="text" placeholder="Enter name..." id="deleteKey">
        <button id="btnDelete">Delete</button>
    </fieldset>

    <fieldset>
        <legend>Local Storage</legend>
        <div>LOGIN / PASSWORD</div>
        <div id="isOutput"></div>
    </fieldset>

    <script>
        // localStorage.setItem('name', 'rafael')
        // localStorage.setItem('age', 39)
        // localStorage.setItem('city', 'americana')
        // //console.log(localStorage)
        // console.log(localStorage.key(2))
        // console.log(localStorage.length)
        // //localStorage.removeItem(localStorage.key(0)) // OR localStorage.removeItem('name')
        // console.log(localStorage)
        // console.log(localStorage.getItem('name'))
        // console.log(localStorage.getItem(localStorage.key(0)))
        //localStorage.clear()
        
        const inpKey = document.querySelector('#inputKey')
const inpValue = document.querySelector('#inputValue')
const btnInsert = document.querySelector('#btnInsert')
const btnDelete = document.querySelector('#btnDelete')
const isOutput = document.querySelector('#isOutput')
const deleteKey = document.querySelector('#deleteKey')

btnInsert.addEventListener('click', () => {
    const key = inpKey.value
    const value = inpValue.value
    
    //console.log(key, value)    
    
    if (key && value) {
    // Check if values in LocalStorage exist
    for (let i = 0; i < localStorage.length; i++) {
        if (localStorage.key(i) == key) {
            alert('Name already taken!')
            return
        }
    }
        localStorage.setItem(key, value)
        location.reload() // refresh the page
    }
})

btnDelete.addEventListener('click', () => {
    for (let i = 0; i < localStorage.length; i++){
        if (deleteKey.value == localStorage.key(i)) {
            localStorage.removeItem(deleteKey.value)
            location.reload()
        }
        // else {
        //     alert('Please, enter a valid key')
        //     return
        // }    
    }        
})

// Print Output
for (let i = 0; i < localStorage.length; i++){
    const key = localStorage.key(i)
    const value = localStorage.getItem(key)
    
    isOutput.innerHTML += `${key}: ${value}<br>`
}        
    </script>

</body>
</html>
